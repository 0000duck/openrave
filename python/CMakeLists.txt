add_subdirectory(bindings)

set(OPENRAVEPY_EGG "${CMAKE_CURRENT_BINARY_DIR}/openravepy-${OPENRAVE_VERSION_MAJOR}.${OPENRAVE_VERSION_MINOR}.egg-info")
configure_file("${CMAKE_CURRENT_SOURCE_DIR}/openravepy.egg-info.in" "${OPENRAVEPY_EGG}" IMMEDIATE @ONLY)
install(FILES "${OPENRAVEPY_EGG}" DESTINATION "${OPENRAVE_PYTHON_INSTALL_DIR}" COMPONENT ${COMPONENT_PREFIX}python)

# python executables need renaming
install(FILES openrave.py DESTINATION bin PERMISSIONS OWNER_EXECUTE OWNER_WRITE OWNER_READ GROUP_EXECUTE GROUP_READ WORLD_EXECUTE WORLD_READ COMPONENT ${COMPONENT_PREFIX}python RENAME openrave${OPENRAVE_BIN_SUFFIX}.py)
install(CODE "execute_process(COMMAND ${CMAKE_COMMAND} -E create_symlink openrave${OPENRAVE_BIN_SUFFIX}.py openrave.py WORKING_DIRECTORY \${CMAKE_INSTALL_PREFIX}/bin)" COMPONENT ${COMPONENT_PREFIX}python)
install(FILES openrave-hash.py DESTINATION bin PERMISSIONS OWNER_EXECUTE OWNER_WRITE OWNER_READ GROUP_EXECUTE GROUP_READ WORLD_EXECUTE WORLD_READ COMPONENT ${COMPONENT_PREFIX}python RENAME openrave${OPENRAVE_BIN_SUFFIX}-hash.py)
install(CODE "execute_process(COMMAND ${CMAKE_COMMAND} -E create_symlink openrave${OPENRAVE_BIN_SUFFIX}-hash.py openrave-hash.py WORKING_DIRECTORY \${CMAKE_INSTALL_PREFIX}/bin)" COMPONENT ${COMPONENT_PREFIX}python)

# install rest python files
install(FILES __init__.py ikfast.py ikfast_generator_cpp.py metaclass.py openravepy_ext.py DESTINATION ${OPENRAVEPY_INSTALL_DIR} COMPONENT ${COMPONENT_PREFIX}python)
install(DIRECTORY "${CMAKE_CURRENT_SOURCE_DIR}/examples" DESTINATION ${OPENRAVEPY_INSTALL_DIR} FILE_PERMISSIONS OWNER_EXECUTE OWNER_WRITE OWNER_READ GROUP_EXECUTE GROUP_READ WORLD_EXECUTE WORLD_READ COMPONENT ${COMPONENT_PREFIX}python PATTERN ".svn" EXCLUDE PATTERN ".pyc" EXCLUDE)
install(DIRECTORY "${CMAKE_CURRENT_SOURCE_DIR}/interfaces" DESTINATION ${OPENRAVEPY_INSTALL_DIR}  FILE_PERMISSIONS OWNER_WRITE OWNER_READ GROUP_READ WORLD_READ COMPONENT ${COMPONENT_PREFIX}python PATTERN ".svn" EXCLUDE PATTERN ".pyc" EXCLUDE)
install(DIRECTORY "${CMAKE_CURRENT_SOURCE_DIR}/databases" DESTINATION ${OPENRAVEPY_INSTALL_DIR}  FILE_PERMISSIONS OWNER_EXECUTE OWNER_WRITE OWNER_READ GROUP_EXECUTE GROUP_READ WORLD_EXECUTE WORLD_READ COMPONENT ${COMPONENT_PREFIX}python PATTERN ".svn" EXCLUDE PATTERN ".pyc" EXCLUDE)

set(CPACK_COMPONENT_${COMPONENT_PREFIX_UPPER}PYTHON_DESCRIPTION "OpenRAVE Python bindings" PARENT_SCOPE)
set(PYTHON_DEPENDS python-numpy)
if( NOT OPENRAVE_USE_LOCAL_SYMPY )
  set(PYTHON_DEPENDS ${PYTHON_DEPENDS} python-sympy)
endif()
set(CPACK_COMPONENT_${COMPONENT_PREFIX_UPPER}PYTHON_DEPENDS ${PYTHON_DEPENDS} PARENT_SCOPE)
set(CPACK_COMPONENTS_ALL ${CPACK_COMPONENTS_ALL} ${COMPONENT_PREFIX}python PARENT_SCOPE)
